import{r as S,g as U,f as q,j as e,o as s}from"./index-24a35cdf.js";import{u as j,s as N,P as W,F as m,I as h,a as p,b as g}from"./zod.module-af5a49a2.js";import{u as Y,s as G,l as Q,a as R,d as A,B as z,A as K,K as J,Q as X}from"./firebase-0ba5c52c.js";import{C as y}from"./constants-4856e09f.js";import{y as D,F as B,v as _,Q as Z}from"./motion-cdcae086.js";import{u as ee}from"./store-42d03b25.js";import{A as te}from"./index.esm-3dace7d2.js";import{G as ie}from"./index.esm-d1f90f26.js";import{a as ae}from"./index.esm-699be640.js";import{f as re}from"./index-0872f226.js";import{B as u,F as se,c as le,a as oe,C as ne,b as ce}from"./index.esm-2b3a3b4e.js";import{a as T}from"./index.esm-72ff9165.js";import"./index-75959897.js";import"./index.esm-f315c78a.js";import"./index.esm-3baeca56.js";import"./iconBase-08f30868.js";import"./index-9ba3ed2e.js";import"./index-b31f775c.js";function de(){const[f,o]=S.exports.useState(!1),[E,l]=S.exports.useState(null),n=Y(),k=U(),i=ee();async function P({date:r,startingMiles:v,endingMiles:b,totalMiles:t,payMiles:M,backhaul:c}){if(o(!0),!(i!=null&&i.userId))return n({title:"You must be logged in to add pay",status:"error",isClosable:!0,position:"top",duration:5e3,colorScheme:"teal",variant:"solid"}),!1;const x=G(R(A,y.USERS,`${i==null?void 0:i.userId}`,y.PAYSHEETS),Q("date","==",r)),w=await z(x);if(w.size>0){const d=w.docs[0].id,F=K(A,y.USERS,`${i==null?void 0:i.userId}`,y.PAYSHEETS,d);try{await J(F,{date:r,uid:i==null?void 0:i.userId,startingMiles:v,endingMiles:b,totalMiles:t,payMiles:M,backhaul:c}),n({title:"Pay updated",status:"success",isClosable:!0,position:"top",duration:5e3,colorScheme:"teal",variant:"solid"}),k(D.DASHBOARD)}catch(C){n({title:"Updating pay failed",description:C.message,status:"error",isClosable:!0,position:"top",duration:5e3,colorScheme:"pink.500",variant:"solid"}),l(C)}return!0}else try{await X(R(A,y.USERS,`${i==null?void 0:i.userId}`,y.PAYSHEETS),{date:r,uid:i==null?void 0:i.userId,startingMiles:v,endingMiles:b,totalMiles:t,payMiles:M,backhaul:c}),n({title:"Pay added",status:"success",isClosable:!0,position:"top",duration:5e3,colorScheme:"teal",variant:"solid"}),k(D.DASHBOARD)}catch(d){n({title:"Adding pay failed",description:d.message,status:"error",isClosable:!0,position:"top",duration:5e3,colorScheme:"pink.500",variant:"solid"}),l(d)}finally{o(!1)}}return{addPay:P,isPayLoading:f,payError:E}}const ue=()=>{const f=q(),o=f==null?void 0:f.state,E=B("white"," gray.800"),l=B("gray.400","gray.500"),n=ae(new Date().toISOString().slice(0,10)),i=(a=>a?{date:re(a.date,"yyyy-MM-dd"),startingMiles:`${a.startingMiles}`,endingMiles:`${a.endingMiles}`,totalMiles:a.totalMiles,payMiles:`${a.payMiles}`,backhaul:`${a.backhaul}`}:{date:n})(o),{addPay:P}=de(),{register:r,handleSubmit:v,watch:b,formState:{errors:t,isDirty:M,isSubmitting:c,isValid:x},control:w,reset:d,getValues:F,setValue:C,setFocus:$}=j({defaultValues:i,resolver:N(W)}),H=a=>{try{P({...a}),d()}catch(I){console.log(I)}},L=()=>{const a=Number(F("startingMiles")),I=Number(F("endingMiles")),O=I-a>0?I-a:0;C("totalMiles",O)};S.exports.useEffect(()=>{L()},[b("startingMiles"),b("endingMiles")]),S.exports.useEffect(()=>{$("startingMiles")},[]);const V=S.exports.useCallback(function(){return o?!0:M&&x&&!c&&!Object.keys(t).length},[M,x,c,t,o])();return e(_.div,{initial:{opacity:0,y:80,scale:.8},animate:{opacity:1,y:0,scale:[.9,1.2,1]},transition:{type:"spring",stiffness:90,damping:15},exit:{opacity:0},children:s(u,{border:"2px",borderColor:"cyan.600",boxShadow:"dark-lg",p:"4",rounded:"md",mt:10,mb:10,w:"60vw",maxW:"500px",minW:"350px",bg:E,children:[e(u,{p:"4",children:s(Z,{onSubmit:v(H),children:[s(m,{isInvalid:!!t.date,isRequired:!0,variant:"floating",children:[e(h,{...r("date"),id:"date",type:"date",placeholder:"date",mb:"3",mt:"3",_placeholder:{color:l}}),e(p,{htmlFor:"date",children:"Date"}),e(g,{children:t.date&&t.date.message})]}),e(u,{my:"3",children:s(m,{isInvalid:!!t.startingMiles,isRequired:!0,variant:"floating",children:[e(h,{...r("startingMiles"),id:"startingMiles",type:"number",placeholder:"Starting Miles",mb:"3",_placeholder:{color:l}}),e(p,{htmlFor:"startingMiles",children:"Starting Miles:"}),e(g,{children:t.startingMiles&&t.startingMiles.message})]})}),e(u,{my:"3",children:s(m,{isInvalid:!!t.endingMiles,isRequired:!0,variant:"floating",children:[e(h,{...r("endingMiles"),id:"endingMiles",type:"number",placeholder:"Ending Miles",mb:"3",_placeholder:{color:l}}),e(p,{htmlFor:"endingMiles",children:"Ending Miles:"}),e(g,{children:t.endingMiles&&t.endingMiles.message})]})}),e(u,{my:"3",children:s(m,{isInvalid:!!t.totalMiles,isRequired:!0,variant:"floating",children:[e(h,{...r("totalMiles"),id:"totalMiles",type:"number",placeholder:"Total Miles",disabled:!0,mb:"3",_placeholder:{color:l}}),e(p,{htmlFor:"totalMiles",children:"Total Miles:"}),e(g,{children:t.totalMiles&&t.totalMiles.message})]})}),e(u,{my:"3",children:s(m,{isInvalid:!!t.payMiles,isRequired:!0,variant:"floating",children:[e(h,{...r("payMiles"),id:"payMiles",type:"number",placeholder:"Pay Miles",mb:"3",_placeholder:{color:l}}),e(p,{htmlFor:"payMiles",children:"Pay Miles:"}),e(g,{children:t.payMiles&&t.payMiles.message})]})}),e(u,{my:"3",children:s(m,{isInvalid:!!t.backhaul,isRequired:!0,variant:"floating",children:[e(h,{...r("backhaul"),id:"backhaul",placeholder:"BackHaul",mb:"3",_placeholder:{color:l}}),e(p,{htmlFor:"backhaul",children:"Backhaul:"}),e(g,{children:t.backhaul&&t.backhaul.message})]})}),s(se,{children:[e(T,{mt:4,px:5,colorScheme:"cyan",isLoading:c,type:"submit",disabled:!V,loadingText:o?"Updating":"Submitting",variant:"outline",_hover:{bg:"cyan.600",color:"white",scale:1.1},rightIcon:e(te,{}),children:"Submit"}),e(le,{}),e(T,{mt:4,colorScheme:"red",onClick:()=>d(),disabled:c,variant:"outline",_hover:{bg:"red.600",color:"white",scale:1.1},rightIcon:e(ie,{}),children:"Reset"})]})]})}),!1]})})},me=ue;function De(){return q(),s(oe,{maxW:"container.xl",centerContent:!0,bg:'"linear(to-b, #42047e, #07f49e)"',children:[e(ne,{children:e(ce,{as:_.h1,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},mt:10,bgGradient:"linear(to-b, #42047e, #07f49e)",bgClip:"text",fontSize:["4xl","4xl","5xl"],fontWeight:"extrabold",children:"Daily Form"})}),e(me,{})]})}export{De as default};
//# sourceMappingURL=DailyPage-418f838f.js.map
